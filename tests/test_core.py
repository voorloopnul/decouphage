from src.core import get_database_default_path, cds_calling_from_genbank, validate_input


def test_path_for_default_database():
    assert ".decouphage/db/ncbi_phages/ncbi_phages.fa" in str(get_database_default_path())


def test_can_identify_file_type():
    assert "GENBANK" == validate_input("tests/data/NC_010391.gb")
    assert "FASTA" == validate_input("tests/data/two_contigs.fasta")


def test_no_orf_calling():
    expected_result = {'NC_010391.1': [
        '>1_33_1358_-', '>2_1386_1628_-', '>3_1636_1782_-', '>4_1779_1994_-', '>5_1994_2302_-', '>6_2299_2523_-',
        '>7_2520_2765_-', '>8_2762_3154_-', '>9_3109_3504_-', '>10_3494_3730_-', '>11_3730_4089_-', '>12_4070_4279_-',
        '>13_4467_4652_-', '>14_4649_4843_-', '>15_4836_5387_-', '>16_5332_6027_-', '>17_6140_6394_+',
        '>18_6357_6653_+', '>19_6894_7262_+', '>20_7375_9003_+', '>21_9000_9968_+', '>22_9968_10828_+',
        '>23_10825_11640_+', '>24_11795_12187_-', '>25_13281_13643_+', '>26_14233_14577_+', '>27_14580_15194_+',
        '>28_15191_15676_+', '>29_16511_17002_+', '>30_16989_19097_+', '>31_19094_19300_+', '>32_19297_20832_+',
        '>33_20750_22870_+', '>34_22959_23282_+', '>35_23275_23550_+', '>36_23554_24138_+', '>37_24135_24536_+',
        '>38_24547_25290_+', '>39_25335_25739_+', '>40_25760_26074_+', '>41_26046_29207_+', '>42_29207_29536_+',
        '>43_29663_30181_+', '>44_30313_31008_+', '>45_31020_31754_+', '>46_31652_32329_+', '>47_32383_32907_-',
        '>48_33052_36447_+', '>49_36491_38863_+', '>50_38863_39438_+', '>51_39509_40657_-', '>52_41321_41692_-'
    ]}

    assert expected_result == cds_calling_from_genbank("tests/data/NC_010391.gb")
